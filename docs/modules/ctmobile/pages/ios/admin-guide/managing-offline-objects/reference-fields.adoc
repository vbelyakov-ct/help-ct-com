= Reference Fields

link:https://developer.salesforce.com/docs/atlas.en-us.api.meta/api/field_types.htm#stq=lookup&stp=1[A
reference field] contains an ID value that points to a unique record on another object. The main record may be associated with a record in the reference field via a lookup or master-detail relationship.

For the reference field, a mobile user can:

* <<Online One Record Fetching, download additional record>> if the reference field refers to the not downloaded record;
* <<Online record search, search value>> or create a new record to add;
* use <<Lookup Filters, lookup filters>> to see records that match required or optional criteria.

[[h2_1514470758]]
== Online One Record Fetching

Along with xref:ios/admin-guide/managing-offline-objects/online-records-fetching.adoc[online records fetching], a mobile user can download one additional record tapping image:62573543.png[25,25] next to the field, which refers to the not downloaded record, on xref:ios/admin-guide/mobile-layouts/index.adoc[the mobile layout] of the linked record.

Online one record fetching is available when:

* one of the downloaded records is linked to a not downloaded record;
* the object of the not downloaded record is available xref:ios/admin-guide/managing-offline-objects/index.adoc[offline].

For example, an _Activity_ record has a lookup field with the _Contact_ record value and another lookup field with
the _Account_ record value. The linked record of the [.object]#Contact# object was downloaded on a mobile device, but the linked record of the [.object]#Account# object is not available offline due to xref:ios/admin-guide/ct-mobile-control-panel/custom-settings/related-list-filters.adoc[Related List Filters]. When a mobile user opens the _Activity_ record, they can open the available related _Contact_ record and download the related _Account_ record to the mobile device.

image::online-one-record-fetching.png[]

To download a record:

. Open the desired record that is associated with the not downloaded record.
. Tap image:62573543.png[25,25] next to the reference field.
. Tap *Yes* to download the record.

The record is synchronized. The mobile layout of the record opens.

* If a current user launches xref:ios/mobile-application/synchronization/synchronization-launch/index.adoc[one of the synchronization modes], the loaded record via online one record fetching will still be available on a mobile device. The record will only be removed after the database is reset.
* If the record's object is not available offline, a mobile user cannot download a record.
* A mobile user can clear value from the reference field by tapping on a field with the record and then tapping the *Clear* button.
* If xref:ios/admin-guide/managing-offline-objects/index.adoc[a record in the reference field was deleted] in the CT Mobile app, the image:deleted.png[] icon next to the reference field will be shown.

[[h2_1554731138]]
== Online record search

Enter a record in the reference field xref:ios/mobile-application/ui/home-screen/search.adoc[using search].
Search is carried out in the fields that are listed on the link:https://help.salesforce.com/articleView?id=search_results_setup_parent.htm&type=5[Search Results] search layout.

To find a record and populate the reference field with it:

. Open the mobile layout of the linked record.
. Tap a reference field. The pop-up for searching records opens.
* Enter a text in the Search box to find a downloaded record. In the search results, tap a record you want to specify in the reference field.
* Tap image:66361426.png[25,25] to create and add a new record to the reference field using xref:ios/admin-guide/mini-layouts.adoc[a mini layout].
* Tap image:detailed-list-view-button.png[25,25] to expand xref:ios/mobile-application/ui/list-views.adoc#h2_1248088428[the detailed list view].
* Tap image:66359461.png[25,25] to online search for a record in Salesforce. In the search results, tap a record and confirm to download it.

NOTE: The CT Mobile app searches the value across all fields listed in Search Results using the SOQL query, for
example: [.apiobject]#WHERE Name LIKE '%Boston%' OR Website LIKE '%Boston%' OR Phone LIKE '%Boston%'#

image::online-record-search.png[]

== Lookup Filters

Lookup filters restrict the valid values and lookup dialog results for the reference field. To create a lookup filter, refer to link:https://help.salesforce.com/articleView?id=sf.fields_lookup_filters_defining.htm&type=5[Salesforce Help].

TIP: If you created or changed the lookup filter, it is necessary to rebuild xref:ios/admin-guide/metadata-checker/metadata-archive/index.adoc[a metadata archive] using xref:ios/admin-guide/metadata-checker/index.adoc[one of the available options] to download the proper lookup filters via synchronization.

Lookup filter can be required or optional:

[[h3_107740449]]
=== Required filter

Only the records that match the lookup filter criteria are available when a user fills out the reference field.

image::required-lookup-filter.png[]

If the created record doesn't match the filter criteria, the lookup field will be empty and the corresponding message will be displayed:

image::record-doesnot-match-filter-criteria.png[]

[[h3_532834476]]
=== Optional filter

All object records are available when a user fills out the reference field. Records that do not match the lookup filter criteria are highlighted in red color.

image::optional-lookup-filter.png[]


[[h3_1126072765]]
=== Limitations on Lookup Filters

* Filter logic with subconditions is not supported. For example, such filter logic will not work:
+
[.apiobject]#(Condition 1) OR ((Condition 2) AND (Condition 3))#
+
In turn, this filter condition will work:
+
[.apiobject]#(Condition 1) OR (Condition 2) AND (Condition 3)#
* Cross objects are not supported. For example, such object specification will not work:
+
[.apiobject]#Territory: Region: Channel#
+
In turn, this object specification will work:
+
[.apiobject]#Account: Channel#


